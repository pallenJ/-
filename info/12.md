# 12

[이전](./11.md)|[index 페이지로](./00index.md) |[다음](./13.md)
---|---|---
<hr>

### 목차
1. [Cookie와 세션](#Cookie와-세션)
1. [Authentication, Authorization](#Authentication-Authorization)
1.

### Cookie와 세션

- cookie
- Servlet Session
  
  + 쿠키는 작은 값을 보관하는 데 도움이 되지만, 그 이상의 것은 할 수 없다. 
  복잡한 값이나 큰 데이터를 보관 해 두는 것은 적합하지 않다. 그러나 액세스하여 각각의 사용자에 대해 어떤 값을 저장해서 두고 싶은 경우는 많다. 
  
  + 이렇게 **각 사용자마다 쿠키보다 복잡하고 큰 데이터를 보관"을 하는 경우에 사용되는 것**이 "세션(session)"이다. 세션이란 서버와 클라이언트(브라우저) 사이의 연결되어 있는 동안 계속 유지 기능이다. 이 세션에 값을 저장하여 두는 것으로, 각 클라이언트에 데이터를 저장하고 관리할 수 있다.

  + 세션은 "HttpSession"라는 클래스로 준비되어 있다. 그러나 사실 인스턴스를 만들거나 할 필요가 없다. 처음부터 "session"이라는 암시 개체가 포함되어 있으며,이를 이용하여 세션을 조작할 수 있도록 되어 있다.
  
  + 세션 값 저장 & 가져오기
  
  >값 저장
  
  ```java
  session.setAttribute(이름, 값);
  ```
  
  > 값 가져오기
  
  ```java
  Object 변수 = session.getAttribute(이름);
  //또는
  ClassName 변수 = (ClassName)session.getAttribute(이름);
  ```
  이외에 다음과 값이 attribute를 사용하지 않는, 더 간단하게 "값을 설정하고 얻어오는" 형태의 메소드도 준비되어 있다.
  ```java
  session.putValue(이름, 값);
  Object 변수 = session.getValue(이름);
  ```
  + 세션 접속시간 및 해제
  
  접속를 시작했을 때 시작해서, 접속해 있는 동안 계속 유지된다. 일정 시간 이상 접속을 하지 않거나 하면 세션도 종료되고 세션에 저장되어 있던 정보도 모두 삭제된다. 브라우저를 종료되었을 경우에는 따로 서버에 통보되지 않기에 실제로는 세션은 살아 있다. 이는 일정 시간 후에 사라지게 된다.

  > 시간을 시작하는 세션 가져오기
  
  ```java
  long 변수 = session.getCreationTime();
  ```
  > 마지막 엑세스 시간 가져오기 
  
  ```java
  long 변수 = session.getLastAccessedTime();
  ```
### Authentication, Authorization
- Authentication
  + 기본적인 방법은 session에 저장된 값을 이용하여 로그인 가능한 유저인지 아닌지 검사하는 기능이다.
  + MVC구조에서 controller에서 session.getAttribute를 사용하여 입력된 값을 가져오며 이 값이 유효한지는 보통 service 에서 mapper나 dao를 이용해서 해당값의 존재여부 혹은 권한을 확인하여 값을 반환한다.
  + 간단하게 controller의 예시를 보이자면 다음과 같다.
  ```java
  @Autowired
  UserService userService //로그인 관련 메소드가 구현된 서비스라고 가정
  
  @PostMapping("/login")
  public void login(HttpSession session,String id , String pw, ModelMap model){
    boolean loginRs = userService.login(id, pw); // 아이디와 비번에 해당하는 사람이 있는지 검사 
    model.addAttribute("login_rs",loginRs);
  }//login_rs 값에 따라 클라이언트에서 화면 분기
  
  ```
  +
  
[이전](./11.md)|[index 페이지로](./00index.md) |[다음](./13.md)
---|---|---
